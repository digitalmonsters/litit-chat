(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92023,e=>{"use strict";var t=e.i(458),r=e.i(91392);e.i(93081);var i=e.i(79888),n=e.i(84979);async function a(e){let t=(0,n.getFirestoreInstance)(),r=(0,i.doc)(t,n.COLLECTIONS.WALLETS,e),a=await (0,i.getDoc)(r);if(a.exists())return{id:a.id,...a.data()};let o={userId:e,stars:0,usd:0,totalEarned:0,totalSpent:0,totalUsdSpent:0,createdAt:(0,i.serverTimestamp)(),updatedAt:(0,i.serverTimestamp)()};return await (0,i.setDoc)(r,o),{id:r.id,...o}}var o=e.i(26493);let l=(0,r.createContext)(void 0);function s(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useWallet must be used within a WalletProvider");return e}function c({children:e}){let{user:s}=(0,o.useAuth)(),[c,d]=(0,r.useState)(null),[u,v]=(0,r.useState)(!0),w=(0,r.useCallback)(async()=>{if(!s){d(null),v(!1);return}try{let e=await a(s.uid);d(e)}catch(e){console.error("Error refreshing wallet:",e)}finally{v(!1)}},[s]);return(0,r.useEffect)(()=>{if(!s){d(null),v(!1);return}v(!0);let e=(0,n.getFirestoreInstance)(),t=(0,i.doc)(e,n.COLLECTIONS.WALLETS,s.uid);a(s.uid).catch(e=>{console.error("Error initializing wallet:",e)});let r=(0,i.onSnapshot)(t,e=>{e.exists()?d({id:e.id,...e.data()}):a(s.uid).then(e=>{d(e)}).catch(e=>{console.error("Error creating wallet:",e)}),v(!1)},e=>{console.error("Error listening to wallet:",e),v(!1)});return()=>{r()}},[s]),(0,t.jsx)(l.Provider,{value:{wallet:c,loading:u,refreshWallet:w},children:e})}e.s(["WalletProvider",()=>c,"useWallet",()=>s],92023)},26895,e=>{"use strict";var t=e.i(458),r=e.i(91392),i=e.i(27405);function n({children:e}){return(0,r.useEffect)(()=>{window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),console.log("âœ… PWA install prompt available"),window.dispatchEvent(new CustomEvent("pwa-install-available"))}),window.addEventListener("appinstalled",()=>{console.log("âœ… PWA installed successfully"),window.dispatchEvent(new CustomEvent("pwa-installed"))}),(0,i.onMessageListener)().then(e=>{e.notification&&console.log("ðŸ“¨ New message:",e.notification)}),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("ðŸ”„ Service worker updated, reloading..."),window.location.reload()})},[]),(0,t.jsx)(t.Fragment,{children:e})}e.s(["default",()=>n],26895)}]);