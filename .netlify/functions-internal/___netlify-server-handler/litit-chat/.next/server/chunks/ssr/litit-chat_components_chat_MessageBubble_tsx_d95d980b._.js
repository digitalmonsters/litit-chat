module.exports=[270,5326,a=>{"use strict";var b=a.i(67304),c=a.i(69494),d=a.i(22027),e=a.i(71118);function f({message:a,onUnlock:f,className:g}){let h=a.attachments?.[0],i=a.unlockPrice?`$${(a.unlockPrice/100).toFixed(2)}`:"$0.00";return h&&a.isLocked?(0,b.jsxs)(c.motion.div,{initial:"hidden",animate:"visible",variants:e.flameFadeIn,onClick:f,className:(0,d.cn)("relative cursor-pointer group","rounded-xl overflow-hidden","bg-gray-900 border-2 border-gray-700","hover:border-[#FF5E3A]/50 transition-all duration-300",g),children:[(0,b.jsxs)("div",{className:"relative aspect-video bg-gray-800",children:[h.type.startsWith("image/")?(0,b.jsx)("img",{src:h.url,alt:h.name,className:"w-full h-full object-cover blur-md scale-110",draggable:!1}):h.type.startsWith("video/")?(0,b.jsx)("video",{src:h.url,className:"w-full h-full object-cover blur-md scale-110",muted:!0,loop:!0}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-16 h-16 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/60"}),(0,b.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3",children:[(0,b.jsxs)(c.motion.div,{animate:{scale:[1,1.1,1],rotate:[0,-5,5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"relative",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-[#FF5E3A] blur-xl opacity-50 rounded-full"}),(0,b.jsx)("svg",{className:"w-16 h-16 text-[#FF5E3A] relative z-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),(0,b.jsx)(c.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"px-4 py-2 bg-gradient-to-r from-[#FF5E3A] to-[#FF9E57] rounded-full",children:(0,b.jsxs)("span",{className:"text-white font-semibold text-lg",children:["Unlock for ",i]})}),(0,b.jsx)(c.motion.p,{initial:{opacity:0},animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},className:"text-gray-300 text-sm",children:"Tap to unlock"})]}),(0,b.jsx)(c.motion.div,{className:"absolute inset-0 opacity-0 group-hover:opacity-20 pointer-events-none",style:{background:"radial-gradient(circle, rgba(255, 94, 58, 0.3) 0%, transparent 70%)"},animate:{scale:[1,1.2,1],opacity:[0,.2,0]},transition:{duration:1.5,repeat:1/0}}),(0,b.jsx)(c.motion.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0,scale:0},whileHover:{opacity:[0,.4,0],scale:[1,1.5,1]},transition:{duration:1,repeat:1/0,ease:"easeOut"},style:{background:"radial-gradient(circle, rgba(255, 94, 58, 0.6) 0%, rgba(255, 158, 87, 0.4) 50%, transparent 100%)"}})]}),(0,b.jsxs)("div",{className:"p-3 bg-gray-800/50 backdrop-blur-sm",children:[(0,b.jsx)("p",{className:"text-sm text-gray-300 truncate",children:h.name??"Locked Content"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:h.size?(h.size/1024).toFixed(1)+" KB":"Size unknown"})]})]}):null}var g=a.i(94839);function h({message:a,isOwn:h,showAvatar:i=!0,showTimestamp:j=!0,onUnlock:k,className:l}){let{user:m}=(0,g.useAuth)(),n=a=>{if(!a)return"";let b=a.toDate?a.toDate():new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/6e4);return c<1?"Just now":c<60?`${c}m ago`:c<1440?`${Math.floor(c/60)}h ago`:b.toLocaleDateString()},o=a.isLocked&&!h,p=a.unlockedBy,q=!!m&&!!p&&(Array.isArray(p)?p.includes(m.uid):"object"==typeof p&&m.uid in p);return o&&!q?(0,b.jsx)(c.motion.div,{initial:"hidden",animate:"visible",variants:e.flameFadeIn,className:(0,d.cn)("flex",h?"justify-end":"justify-start",l),children:(0,b.jsxs)("div",{className:(0,d.cn)("max-w-[80%]",h?"md:max-w-[60%]":"md:max-w-[70%]"),children:[(0,b.jsx)(f,{message:a,onUnlock:()=>k?.(a)}),j&&(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1 ml-2",children:n(a.timestamp)})]})}):(0,b.jsxs)(c.motion.div,{initial:"hidden",animate:"visible",variants:e.flameFadeIn,className:(0,d.cn)("flex items-end gap-2 px-4 py-2",h?"flex-row-reverse":"flex-row",l),children:[i&&!h&&(0,b.jsx)("div",{className:"flex-shrink-0",children:a.senderAvatar?(0,b.jsx)("img",{src:a.senderAvatar,alt:a.senderName??"User",className:"w-8 h-8 rounded-full object-cover"}):(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-[#FF5E3A] to-[#FF9E57] flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-white text-xs font-semibold",children:a.senderName?.charAt(0)?.toUpperCase()??"?"})})}),(0,b.jsxs)("div",{className:(0,d.cn)("flex flex-col gap-1",h?"items-end":"items-start",i&&!h?"max-w-[70%]":"max-w-[80%]"),children:[!h&&(0,b.jsx)("span",{className:"text-xs font-medium text-gray-400",children:a.senderName??"Unknown"}),(0,b.jsxs)("div",{className:(0,d.cn)("rounded-2xl px-4 py-2 shadow-sm",h?"bg-gradient-to-r from-[#FF5E3A] to-[#FF9E57] text-white":"bg-gray-800 text-white"),children:[a.content&&(0,b.jsx)("p",{className:"break-words text-sm leading-relaxed",children:a.content}),a.attachments?.some(a=>a.type.startsWith("image/"))&&(0,b.jsx)("div",{className:"mt-2 space-y-2",children:a.attachments.filter(a=>a.type.startsWith("image/")).map((a,c)=>(0,b.jsx)("img",{src:a.url,alt:a.name,className:"max-w-full rounded-lg"},c))}),a.attachments?.some(a=>a.type.startsWith("video/"))&&(0,b.jsx)("div",{className:"mt-2 space-y-2",children:a.attachments.filter(a=>a.type.startsWith("video/")).map((a,c)=>(0,b.jsx)("video",{src:a.url,controls:!0,className:"max-w-full rounded-lg"},c))}),a.attachments?.some(a=>a.type.startsWith("audio/"))&&(0,b.jsx)("div",{className:"mt-2 space-y-2",children:a.attachments.filter(a=>a.type.startsWith("audio/")).map((a,c)=>(0,b.jsx)("audio",{src:a.url,controls:!0,className:"w-full"},c))}),a.attachments?.some(a=>!a.type.startsWith("image/")&&!a.type.startsWith("video/")&&!a.type.startsWith("audio/"))&&(0,b.jsx)("div",{className:"mt-2 space-y-2",children:a.attachments.filter(a=>!a.type.startsWith("image/")&&!a.type.startsWith("video/")&&!a.type.startsWith("audio/")).map((a,c)=>(0,b.jsxs)("a",{href:a.url,download:a.name,className:"flex items-center gap-2 p-2 bg-black/20 rounded-lg hover:bg-black/30 transition-colors",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),(0,b.jsx)("span",{className:"text-sm",children:a.name})]},c))}),a.isEdited&&(0,b.jsx)("span",{className:"ml-2 text-xs opacity-70",children:"(edited)"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[j&&(0,b.jsx)("span",{className:"text-xs text-gray-500",children:n(a.timestamp)}),h&&a.status&&(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["sending"===a.status&&"â³","sent"===a.status&&"âœ“","delivered"===a.status&&"âœ“âœ“","read"===a.status&&"âœ“âœ“","failed"===a.status&&"âœ—"]})]})]}),i&&h&&(0,b.jsx)("div",{className:"h-8 w-8 flex-shrink-0"})]})}a.s(["default",()=>h],270);var i=a.i(90295),j=a.i(85487),k=a.i(64274);a.i(81668);var l=a.i(18114),m=a.i(1448);function n({chatId:a,placeholder:e="Type a message...",disabled:f=!1,className:h}){let{user:n}=(0,g.useAuth)(),[o,p]=(0,i.useState)(""),[q,r]=(0,i.useState)(null),[s,t]=(0,i.useState)(null),[u,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)(""),[y,z]=(0,i.useState)(!1),A=(0,i.useRef)(null),B=(0,i.useRef)(null),C=async()=>{if((o.trim()||q)&&!f&&n){z(!0);try{let b=(0,m.getFirestoreInstance)(),c=(0,l.collection)(b,`${m.COLLECTIONS.CHATS}/${a}/${m.COLLECTIONS.MESSAGES}`),d=[],e="text";if(q)if(q.type.startsWith("image/")){e="image";let b=await (0,k.compressImage)(q,1200,.85),c=await (0,k.uploadChatImage)(a,b);d.push({url:c,type:q.type,name:q.name,size:b.size})}else q.type.startsWith("video/")||q.type.startsWith("audio/"),e="file",d.push({url:URL.createObjectURL(q),type:q.type,name:q.name,size:q.size});let f={chatId:a,senderId:n.uid,senderName:n.displayName||"User",senderAvatar:n.photoURL||void 0,content:o||(q?q.name:""),type:e,status:"sending",timestamp:(0,l.serverTimestamp)(),createdAt:(0,l.serverTimestamp)(),attachments:d.length>0?d:void 0,isLocked:!!u&&!!q||void 0,unlockPrice:u&&w?Math.round(100*parseFloat(w)):void 0,unlockCurrency:u&&w?"USD":void 0},g=await (0,l.addDoc)(c,f);await (0,l.updateDoc)(g,{status:"sent"});let h=(0,l.doc)(b,m.COLLECTIONS.CHATS,a);await (0,l.updateDoc)(h,{lastMessageId:g.id,lastMessageAt:(0,l.serverTimestamp)(),updatedAt:(0,l.serverTimestamp)()}),p(""),r(null),t(null),v(!1),x(""),A.current&&(A.current.style.height="auto")}catch(a){console.error("Error sending message:",a)}finally{z(!1)}}};return(0,b.jsxs)("div",{className:(0,d.cn)("bg-[#1E1E1E] border-t border-gray-800",h),children:[(0,b.jsx)(j.AnimatePresence,{children:q&&(0,b.jsxs)(c.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"p-4 border-b border-gray-800",children:[(0,b.jsx)("div",{className:"relative",children:s?(0,b.jsx)("img",{src:s,alt:"Preview",className:"w-full max-h-48 object-cover rounded-lg"}):(0,b.jsxs)("div",{className:"p-4 bg-gray-800 rounded-lg flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-white text-sm font-medium",children:q.name}),(0,b.jsxs)("p",{className:"text-gray-400 text-xs",children:[(q.size/1024).toFixed(1)," KB"]})]}),(0,b.jsx)("button",{onClick:()=>{r(null),t(null)},className:"text-gray-400 hover:text-white",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,b.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:u,onChange:a=>v(a.target.checked),className:"w-4 h-4 rounded border-gray-700 bg-gray-800 text-[#FF5E3A] focus:ring-[#FF5E3A]"}),(0,b.jsx)("span",{className:"text-sm text-gray-300",children:"ðŸ’° Set Price to Unlock"})]}),u&&(0,b.jsxs)(c.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-gray-400",children:"$"}),(0,b.jsx)("input",{type:"number",value:w,onChange:a=>x(a.target.value),placeholder:"0.00",min:"0",step:"0.01",className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-[#FF5E3A]"})]})]})]})}),(0,b.jsxs)("div",{className:"flex items-end gap-2 p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("button",{onClick:()=>B.current?.click(),disabled:f||y,className:"flex-shrink-0 w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center text-gray-400 hover:text-white transition-colors disabled:opacity-50",title:"Upload media",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),(0,b.jsx)("button",{onClick:()=>{B.current?.click()},disabled:f||y,className:"flex-shrink-0 w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center text-gray-400 hover:text-white transition-colors disabled:opacity-50",title:"Take photo/video",children:(0,b.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),(0,b.jsx)("input",{ref:B,type:"file",accept:"image/*,video/*,audio/*",capture:"environment",onChange:a=>{let b=a.target.files?.[0];if(b)if(r(b),b.type.startsWith("image/")){let a=new FileReader;a.onloadend=()=>{t(a.result)},a.readAsDataURL(b)}else t(null)},className:"hidden"}),(0,b.jsx)("textarea",{ref:A,value:o,onChange:a=>{p(a.target.value),A.current&&(A.current.style.height="auto",A.current.style.height=`${A.current.scrollHeight}px`)},onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),C())},placeholder:e,disabled:f||y,rows:1,className:(0,d.cn)("flex-1 max-h-32 resize-none rounded-lg border border-gray-700 bg-gray-800 px-4 py-2 text-sm text-white placeholder-gray-400","focus:outline-none focus:border-[#FF5E3A] focus:ring-1 focus:ring-[#FF5E3A]","disabled:cursor-not-allowed disabled:opacity-50")}),(0,b.jsx)(c.motion.button,{onClick:C,disabled:!o.trim()&&!q||f||y,whileHover:{scale:y?1:1.05},whileTap:{scale:y?1:.95},className:(0,d.cn)("flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center transition-all",(o.trim()||q)&&!f&&!y?"bg-gradient-to-r from-[#FF5E3A] to-[#FF9E57] text-white hover:from-[#FF6E4A] hover:to-[#FFAE67]":"bg-gray-800 text-gray-400 cursor-not-allowed"),children:y?(0,b.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})}a.s(["default",()=>n],5326)}];

//# sourceMappingURL=litit-chat_components_chat_MessageBubble_tsx_d95d980b._.js.map